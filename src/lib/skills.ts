export interface Skill {
  name: string;
  logo: string;
  color?: string;
}

export const SKILLS_DATABASE: Record<string, Skill> = {
  react: {
    name: "React",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/react/react-original.svg",
    color: "#61dafb",
  },
  "node.js": {
    name: "Node.js",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/nodejs/nodejs-original.svg",
    color: "#68a063",
  },
  nodejs: {
    name: "Node.js",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/nodejs/nodejs-original.svg",
    color: "#68a063",
  },
  express: {
    name: "Express",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/express/express-original.svg",
    color: "#000000",
  },
  mongodb: {
    name: "MongoDB",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/mongodb/mongodb-original.svg",
    color: "#13aa52",
  },
  typescript: {
    name: "TypeScript",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/typescript/typescript-original.svg",
    color: "#3178c6",
  },
  javascript: {
    name: "JavaScript",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/javascript/javascript-original.svg",
    color: "#f7df1e",
  },
  python: {
    name: "Python",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/python/python-original.svg",
    color: "#3776ab",
  },
  java: {
    name: "Java",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/java/java-original.svg",
    color: "#007396",
  },
  "c++": {
    name: "C++",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/cplusplus/cplusplus-original.svg",
    color: "#00599c",
  },
  angular: {
    name: "Angular",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/angularjs/angularjs-original.svg",
    color: "#dd0031",
  },
  vue: {
    name: "Vue",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/vuejs/vuejs-original.svg",
    color: "#42b983",
  },
  nextjs: {
    name: "Next.js",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/nextjs/nextjs-original.svg",
    color: "#000000",
  },
  "next.js": {
    name: "Next.js",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/nextjs/nextjs-original.svg",
    color: "#000000",
  },
  postgresql: {
    name: "PostgreSQL",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/postgresql/postgresql-original.svg",
    color: "#336791",
  },
  mysql: {
    name: "MySQL",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/mysql/mysql-original.svg",
    color: "#00758f",
  },
  docker: {
    name: "Docker",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/docker/docker-original.svg",
    color: "#2496ed",
  },
  kubernetes: {
    name: "Kubernetes",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/kubernetes/kubernetes-plain.svg",
    color: "#326ce5",
  },
  git: {
    name: "Git",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/git/git-original.svg",
    color: "#f1502f",
  },
  aws: {
    name: "AWS",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/amazonwebservices/amazonwebservices-original.svg",
    color: "#ff9900",
  },
  azure: {
    name: "Azure",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/azure/azure-original.svg",
    color: "#0078d4",
  },
  gcp: {
    name: "GCP",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/googlecloud/googlecloud-original.svg",
    color: "#4285f4",
  },
  "google cloud": {
    name: "Google Cloud",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/googlecloud/googlecloud-original.svg",
    color: "#4285f4",
  },
  redis: {
    name: "Redis",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/redis/redis-original.svg",
    color: "#dc382d",
  },
  graphql: {
    name: "GraphQL",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/graphql/graphql-plain.svg",
    color: "#e535ab",
  },
  rest: {
    name: "REST",
    logo: "https://api.iconify.design/logos-rest.svg",
    color: "#39b54a",
  },
  restapi: {
    name: "REST API",
    logo: "https://api.iconify.design/logos-rest.svg",
    color: "#39b54a",
  },
  "rest api": {
    name: "REST API",
    logo: "https://api.iconify.design/logos-rest.svg",
    color: "#39b54a",
  },
  html: {
    name: "HTML",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/html5/html5-original.svg",
    color: "#e34c26",
  },
  css: {
    name: "CSS",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/css3/css3-original.svg",
    color: "#563d7c",
  },
  tailwind: {
    name: "Tailwind CSS",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/tailwindcss/tailwindcss-original.svg",
    color: "#38b2ac",
  },
  "tailwind css": {
    name: "Tailwind CSS",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/tailwindcss/tailwindcss-original.svg",
    color: "#38b2ac",
  },
  bootstrap: {
    name: "Bootstrap",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/bootstrap/bootstrap-original.svg",
    color: "#7952b3",
  },
  figma: {
    name: "Figma",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/figma/figma-original.svg",
    color: "#f24e1e",
  },
  github: {
    name: "GitHub",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/github/github-original.svg",
    color: "#181717",
  },
  linkedin: {
    name: "LinkedIn",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/linkedin/linkedin-original.svg",
    color: "#0a66c2",
  },
  google: {
    name: "Google",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/google/google-original.svg",
    color: "#4285f4",
  },
  rust: {
    name: "Rust",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/rust/rust-original.svg",
    color: "#ce422b",
  },
  tensorflow: {
    name: "TensorFlow",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/tensorflow/tensorflow-original.svg",
    color: "#ff6f00",
  },
  pytorch: {
    name: "PyTorch",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/pytorch/pytorch-original.svg",
    color: "#ee4c2c",
  },
  "machine learning": {
    name: "Machine Learning",
    logo: "https://api.iconify.design/mdi-brain.svg",
    color: "#ff6f00",
  },
  "deep learning": {
    name: "Deep Learning",
    logo: "https://api.iconify.design/mdi-brain.svg",
    color: "#ff6f00",
  },
  "artificial intelligence": {
    name: "Artificial Intelligence",
    logo: "https://api.iconify.design/mdi-robot.svg",
    color: "#ff6f00",
  },
  ai: {
    name: "AI",
    logo: "https://api.iconify.design/mdi-robot.svg",
    color: "#ff6f00",
  },
  nlp: {
    name: "NLP",
    logo: "https://api.iconify.design/mdi-language-python.svg",
    color: "#3776ab",
  },
  "natural language processing": {
    name: "Natural Language Processing",
    logo: "https://api.iconify.design/mdi-language-python.svg",
    color: "#3776ab",
  },
  scikit: {
    name: "Scikit-Learn",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/scikitlearn/scikitlearn-original.svg",
    color: "#f7931e",
  },
  "scikit-learn": {
    name: "Scikit-Learn",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/scikitlearn/scikitlearn-original.svg",
    color: "#f7931e",
  },
  pandas: {
    name: "Pandas",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/pandas/pandas-original.svg",
    color: "#150458",
  },
  numpy: {
    name: "NumPy",
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/numpy/numpy-original.svg",
    color: "#013243",
  },
  openai: {
    name: "OpenAI",
    logo: "https://api.iconify.design/simple-icons-openai.svg",
    color: "#412991",
  },
  chatgpt: {
    name: "ChatGPT",
    logo: "https://api.iconify.design/simple-icons-openai.svg",
    color: "#412991",
  },
  "chat gpt": {
    name: "ChatGPT",
    logo: "https://api.iconify.design/simple-icons-openai.svg",
    color: "#412991",
  },
};

/**
 * Escape special regex characters in a string
 */
function escapeRegex(str: string): string {
  return str.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}

/**
 * Extract skills from interview description text
 * Matches skill names case-insensitively and returns unique skills found
 */
export function extractSkillsFromDescription(description: string): Skill[] {
  if (!description) {return [];}

  const foundSkills = new Set<Skill>();
  const descriptionLower = description.toLowerCase();

  // Search for each skill in the description
  Object.entries(SKILLS_DATABASE).forEach(([key, skill]) => {
    // Create a word boundary regex to match whole words only
    // Escape special regex characters in the key first
    const escapedKey = escapeRegex(key);
    const regex = new RegExp(`\\b${escapedKey}\\b`, "gi");
    if (regex.test(descriptionLower)) {
      foundSkills.add(skill);
    }
  });

  // Convert Set to Array and return unique skills (by name)
  return Array.from(foundSkills).filter(
    (skill, index, self) =>
      index === self.findIndex((s) => s.name === skill.name),
  );
}
